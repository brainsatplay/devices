"use strict";(()=>{var wo=Object.create;var pe=Object.defineProperty,Do=Object.defineProperties,ko=Object.getOwnPropertyDescriptor,Ao=Object.getOwnPropertyDescriptors,Eo=Object.getOwnPropertyNames,Ce=Object.getOwnPropertySymbols,vo=Object.getPrototypeOf,Te=Object.prototype.hasOwnProperty,kt=Object.prototype.propertyIsEnumerable;var Dt=(e,t,n)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Z=(e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&Dt(e,n,t[n]);if(Ce)for(var n of Ce(t))kt.call(t,n)&&Dt(e,n,t[n]);return e},j=(e,t)=>Do(e,Ao(t));var At=(e,t)=>{var n={};for(var r in e)Te.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ce)for(var r of Ce(e))t.indexOf(r)<0&&kt.call(e,r)&&(n[r]=e[r]);return n};var To=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ro=(e,t)=>{for(var n in t)pe(e,n,{get:t[n],enumerable:!0})},No=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Eo(t))!Te.call(e,a)&&a!==n&&pe(e,a,{get:()=>t[a],enumerable:!(r=ko(t,a))||r.enumerable});return e};var _o=(e,t,n)=>(n=e!=null?wo(vo(e)):{},No(t||!e||!e.__esModule?pe(n,"default",{value:e,enumerable:!0}):n,e));var X=(e,t,n)=>new Promise((r,a)=>{var i=l=>{try{s(n.next(l))}catch(u){a(u)}},c=l=>{try{s(n.throw(l))}catch(u){a(u)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,c);s((n=n.apply(e,t)).next())});var Xt=To((fl,Se)=>{var Et,vt,Tt,Rt,Nt,_t,Ft,Mt,Gt,he,Re,Ut,Lt,Ht,L,zt,Vt,Qt,Wt,qt,Yt,$t,Zt,jt,be;(function(e){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(r){e(n(t,n(r)))}):typeof Se=="object"&&typeof Se.exports=="object"?e(n(t,n(Se.exports))):e(n(t));function n(r,a){return r!==t&&(typeof Object.create=="function"?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0),function(i,c){return r[i]=a?a(i,c):c}}})(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(r[i]=a[i])};Et=function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");t(r,a);function i(){this.constructor=r}r.prototype=a===null?Object.create(a):(i.prototype=a.prototype,new i)},vt=Object.assign||function(r){for(var a,i=1,c=arguments.length;i<c;i++){a=arguments[i];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])}return r},Tt=function(r,a){var i={};for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&a.indexOf(c)<0&&(i[c]=r[c]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,c=Object.getOwnPropertySymbols(r);s<c.length;s++)a.indexOf(c[s])<0&&Object.prototype.propertyIsEnumerable.call(r,c[s])&&(i[c[s]]=r[c[s]]);return i},Rt=function(r,a,i,c){var s=arguments.length,l=s<3?a:c===null?c=Object.getOwnPropertyDescriptor(a,i):c,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(r,a,i,c);else for(var f=r.length-1;f>=0;f--)(u=r[f])&&(l=(s<3?u(l):s>3?u(a,i,l):u(a,i))||l);return s>3&&l&&Object.defineProperty(a,i,l),l},Nt=function(r,a){return function(i,c){a(i,c,r)}},_t=function(r,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,a)},Ft=function(r,a,i,c){function s(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function f(p){try{m(c.next(p))}catch(B){u(B)}}function b(p){try{m(c.throw(p))}catch(B){u(B)}}function m(p){p.done?l(p.value):s(p.value).then(f,b)}m((c=c.apply(r,a||[])).next())})},Mt=function(r,a){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},c,s,l,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(m){return function(p){return b([m,p])}}function b(m){if(c)throw new TypeError("Generator is already executing.");for(;i;)try{if(c=1,s&&(l=m[0]&2?s.return:m[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,m[1])).done)return l;switch(s=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return i.label++,{value:m[1],done:!1};case 5:i.label++,s=m[1],m=[0];continue;case 7:m=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){i=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){i.label=m[1];break}if(m[0]===6&&i.label<l[1]){i.label=l[1],l=m;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(m);break}l[2]&&i.ops.pop(),i.trys.pop();continue}m=a.call(r,i)}catch(p){m=[6,p],s=0}finally{c=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Gt=function(r,a){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&be(a,r,i)},be=Object.create?function(r,a,i,c){c===void 0&&(c=i);var s=Object.getOwnPropertyDescriptor(a,i);(!s||("get"in s?!a.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return a[i]}}),Object.defineProperty(r,c,s)}:function(r,a,i,c){c===void 0&&(c=i),r[c]=a[i]},he=function(r){var a=typeof Symbol=="function"&&Symbol.iterator,i=a&&r[a],c=0;if(i)return i.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&c>=r.length&&(r=void 0),{value:r&&r[c++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")},Re=function(r,a){var i=typeof Symbol=="function"&&r[Symbol.iterator];if(!i)return r;var c=i.call(r),s,l=[],u;try{for(;(a===void 0||a-- >0)&&!(s=c.next()).done;)l.push(s.value)}catch(f){u={error:f}}finally{try{s&&!s.done&&(i=c.return)&&i.call(c)}finally{if(u)throw u.error}}return l},Ut=function(){for(var r=[],a=0;a<arguments.length;a++)r=r.concat(Re(arguments[a]));return r},Lt=function(){for(var r=0,a=0,i=arguments.length;a<i;a++)r+=arguments[a].length;for(var c=Array(r),s=0,a=0;a<i;a++)for(var l=arguments[a],u=0,f=l.length;u<f;u++,s++)c[s]=l[u];return c},Ht=function(r,a,i){if(i||arguments.length===2)for(var c=0,s=a.length,l;c<s;c++)(l||!(c in a))&&(l||(l=Array.prototype.slice.call(a,0,c)),l[c]=a[c]);return r.concat(l||Array.prototype.slice.call(a))},L=function(r){return this instanceof L?(this.v=r,this):new L(r)},zt=function(r,a,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=i.apply(r,a||[]),s,l=[];return s={},u("next"),u("throw"),u("return"),s[Symbol.asyncIterator]=function(){return this},s;function u(C){c[C]&&(s[C]=function(x){return new Promise(function(h,T){l.push([C,x,h,T])>1||f(C,x)})})}function f(C,x){try{b(c[C](x))}catch(h){B(l[0][3],h)}}function b(C){C.value instanceof L?Promise.resolve(C.value.v).then(m,p):B(l[0][2],C)}function m(C){f("next",C)}function p(C){f("throw",C)}function B(C,x){C(x),l.shift(),l.length&&f(l[0][0],l[0][1])}},Vt=function(r){var a,i;return a={},c("next"),c("throw",function(s){throw s}),c("return"),a[Symbol.iterator]=function(){return this},a;function c(s,l){a[s]=r[s]?function(u){return(i=!i)?{value:L(r[s](u)),done:s==="return"}:l?l(u):u}:l}},Qt=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r[Symbol.asyncIterator],i;return a?a.call(r):(r=typeof he=="function"?he(r):r[Symbol.iterator](),i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i);function c(l){i[l]=r[l]&&function(u){return new Promise(function(f,b){u=r[l](u),s(f,b,u.done,u.value)})}}function s(l,u,f,b){Promise.resolve(b).then(function(m){l({value:m,done:f})},u)}},Wt=function(r,a){return Object.defineProperty?Object.defineProperty(r,"raw",{value:a}):r.raw=a,r};var n=Object.create?function(r,a){Object.defineProperty(r,"default",{enumerable:!0,value:a})}:function(r,a){r.default=a};qt=function(r){if(r&&r.__esModule)return r;var a={};if(r!=null)for(var i in r)i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)&&be(a,r,i);return n(a,r),a},Yt=function(r){return r&&r.__esModule?r:{default:r}},$t=function(r,a,i,c){if(i==="a"&&!c)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?r!==a||!c:!a.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?c:i==="a"?c.call(r):c?c.value:a.get(r)},Zt=function(r,a,i,c,s){if(c==="m")throw new TypeError("Private method is not writable");if(c==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?r!==a||!s:!a.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return c==="a"?s.call(r,i):s?s.value=i:a.set(r,i),i},jt=function(r,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?a===r:r.has(a)},e("__extends",Et),e("__assign",vt),e("__rest",Tt),e("__decorate",Rt),e("__param",Nt),e("__metadata",_t),e("__awaiter",Ft),e("__generator",Mt),e("__exportStar",Gt),e("__createBinding",be),e("__values",he),e("__read",Re),e("__spread",Ut),e("__spreadArrays",Lt),e("__spreadArray",Ht),e("__await",L),e("__asyncGenerator",zt),e("__asyncDelegator",Vt),e("__asyncValues",Qt),e("__makeTemplateObject",Wt),e("__importStar",qt),e("__importDefault",Yt),e("__classPrivateFieldGet",$t),e("__classPrivateFieldSet",Zt),e("__classPrivateFieldIn",jt)})});var ve={};Ro(ve,{Ganglion:()=>de,device:()=>ul});var Kt=_o(Xt(),1),{__extends:w,__assign:dl,__rest:Cl,__decorate:pl,__param:hl,__metadata:bl,__awaiter:Jt,__generator:ye,__exportStar:Sl,__createBinding:yl,__values:_,__read:D,__spread:Il,__spreadArrays:Bl,__spreadArray:R,__await:Ie,__asyncGenerator:en,__asyncDelegator:Ol,__asyncValues:tn,__makeTemplateObject:gl,__importStar:xl,__importDefault:Pl,__classPrivateFieldGet:wl,__classPrivateFieldSet:Dl,__classPrivateFieldIn:kl}=Kt.default;function d(e){return typeof e=="function"}function H(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Be=H(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,a){return a+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function K(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var z=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,a,i;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var s=_(c),l=s.next();!l.done;l=s.next()){var u=l.value;u.remove(this)}}catch(C){t={error:C}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}else c.remove(this);var f=this.initialTeardown;if(d(f))try{f()}catch(C){i=C instanceof Be?C.errors:[C]}var b=this._finalizers;if(b){this._finalizers=null;try{for(var m=_(b),p=m.next();!p.done;p=m.next()){var B=p.value;try{nn(B)}catch(C){i=i??[],C instanceof Be?i=R(R([],D(i)),D(C.errors)):i.push(C)}}}catch(C){r={error:C}}finally{try{p&&!p.done&&(a=m.return)&&a.call(m)}finally{if(r)throw r.error}}}if(i)throw new Be(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)nn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&K(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&K(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var Ne=z.EMPTY;function Oe(e){return e instanceof z||e&&"closed"in e&&d(e.remove)&&d(e.add)&&d(e.unsubscribe)}function nn(e){d(e)?e():e.unsubscribe()}var P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var V={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a=V.delegate;return a?.setTimeout?a.setTimeout.apply(a,R([e,t],D(n))):setTimeout.apply(void 0,R([e,t],D(n)))},clearTimeout:function(e){var t=V.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function ge(e){V.setTimeout(function(){var t=P.onUnhandledError;if(t)t(e);else throw e})}function J(){}var rn=function(){return _e("C",void 0,void 0)}();function an(e){return _e("E",void 0,e)}function on(e){return _e("N",e,void 0)}function _e(e,t,n){return{kind:e,value:t,error:n}}var F=null;function Q(e){if(P.useDeprecatedSynchronousErrorHandling){var t=!F;if(t&&(F={errorThrown:!1,error:null}),e(),t){var n=F,r=n.errorThrown,a=n.error;if(F=null,r)throw a}}else e()}function cn(e){P.useDeprecatedSynchronousErrorHandling&&F&&(F.errorThrown=!0,F.error=e)}var ee=function(e){w(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Oe(n)&&n.add(r)):r.destination=Uo,r}return t.create=function(n,r,a){return new Pe(n,r,a)},t.prototype.next=function(n){this.isStopped?Me(on(n),this):this._next(n)},t.prototype.error=function(n){this.isStopped?Me(an(n),this):(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped?Me(rn,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(z);var Fo=Function.prototype.bind;function Fe(e,t){return Fo.call(e,t)}var Mo=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){xe(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){xe(r)}else xe(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){xe(n)}},e}(),Pe=function(e){w(t,e);function t(n,r,a){var i=e.call(this)||this,c;if(d(n)||!n)c={next:n??void 0,error:r??void 0,complete:a??void 0};else{var s;i&&P.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return i.unsubscribe()},c={next:n.next&&Fe(n.next,s),error:n.error&&Fe(n.error,s),complete:n.complete&&Fe(n.complete,s)}):c=n}return i.destination=new Mo(c),i}return t}(ee);function xe(e){P.useDeprecatedSynchronousErrorHandling?cn(e):ge(e)}function Go(e){throw e}function Me(e,t){var n=P.onStoppedNotification;n&&V.setTimeout(function(){return n(e,t)})}var Uo={closed:!0,next:J,error:Go,complete:J};var W=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function q(e){return e}function sn(e){return e.length===0?q:e.length===1?e[0]:function(n){return e.reduce(function(r,a){return a(r)},n)}}var O=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var a=this,i=Ho(t)?t:new Pe(t,n,r);return Q(function(){var c=a,s=c.operator,l=c.source;i.add(s?s.call(i,l):l?a._subscribe(i):a._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=ln(n),new n(function(a,i){var c=new Pe({next:function(s){try{t(s)}catch(l){i(l),c.unsubscribe()}},error:i,complete:a});r.subscribe(c)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[W]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return sn(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=ln(t),new t(function(r,a){var i;n.subscribe(function(c){return i=c},function(c){return a(c)},function(){return r(i)})})},e.create=function(t){return new e(t)},e}();function ln(e){var t;return(t=e??P.Promise)!==null&&t!==void 0?t:Promise}function Lo(e){return e&&d(e.next)&&d(e.error)&&d(e.complete)}function Ho(e){return e&&e instanceof ee||Lo(e)&&Oe(e)}function zo(e){return d(e?.lift)}function y(e){return function(t){if(zo(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function S(e,t,n,r,a){return new Vo(e,t,n,r,a)}var Vo=function(e){w(t,e);function t(n,r,a,i,c,s){var l=e.call(this,n)||this;return l.onFinalize=c,l.shouldUnsubscribe=s,l._next=r?function(u){try{r(u)}catch(f){n.error(f)}}:e.prototype._next,l._error=i?function(u){try{i(u)}catch(f){n.error(f)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=a?function(){try{a()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(ee);var un=H(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var M=function(e){w(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new mn(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new un},t.prototype.next=function(n){var r=this;Q(function(){var a,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var c=_(r.currentObservers),s=c.next();!s.done;s=c.next()){var l=s.value;l.next(n)}}catch(u){a={error:u}}finally{try{s&&!s.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}}})},t.prototype.error=function(n){var r=this;Q(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var a=r.observers;a.length;)a.shift().error(n)}})},t.prototype.complete=function(){var n=this;Q(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,a=this,i=a.hasError,c=a.isStopped,s=a.observers;return i||c?Ne:(this.currentObservers=null,s.push(n),new z(function(){r.currentObservers=null,K(s,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,a=r.hasError,i=r.thrownError,c=r.isStopped;a?n.error(i):c&&n.complete()},t.prototype.asObservable=function(){var n=new O;return n.source=this,n},t.create=function(n,r){return new mn(n,r)},t}(O);var mn=function(e){w(t,e);function t(n,r){var a=e.call(this)||this;return a.destination=n,a.source=r,a}return t.prototype.next=function(n){var r,a;(a=(r=this.destination)===null||r===void 0?void 0:r.next)===null||a===void 0||a.call(r,n)},t.prototype.error=function(n){var r,a;(a=(r=this.destination)===null||r===void 0?void 0:r.error)===null||a===void 0||a.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,a;return(a=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&a!==void 0?a:Ne},t}(M);var Ge=function(e){w(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,a=n.thrownError,i=n._value;if(r)throw a;return this._throwIfClosed(),i},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t}(M);var fn=new O(function(e){return e.complete()});var we=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function dn(e){return d(e?.then)}function Cn(e){return d(e[W])}function pn(e){return Symbol.asyncIterator&&d(e?.[Symbol.asyncIterator])}function hn(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Qo(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var bn=Qo();function Sn(e){return d(e?.[bn])}function yn(e){return en(this,arguments,function(){var n,r,a,i;return ye(this,function(c){switch(c.label){case 0:n=e.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,Ie(n.read())];case 3:return r=c.sent(),a=r.value,i=r.done,i?[4,Ie(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,Ie(a)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function In(e){return d(e?.getReader)}function N(e){if(e instanceof O)return e;if(e!=null){if(Cn(e))return Wo(e);if(we(e))return qo(e);if(dn(e))return Yo(e);if(pn(e))return Bn(e);if(Sn(e))return $o(e);if(In(e))return Zo(e)}throw hn(e)}function Wo(e){return new O(function(t){var n=e[W]();if(d(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function qo(e){return new O(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Yo(e){return new O(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,ge)})}function $o(e){return new O(function(t){var n,r;try{for(var a=_(e),i=a.next();!i.done;i=a.next()){var c=i.value;if(t.next(c),t.closed)return}}catch(s){n={error:s}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}t.complete()})}function Bn(e){return new O(function(t){jo(e,t).catch(function(n){return t.error(n)})})}function Zo(e){return Bn(yn(e))}function jo(e,t){var n,r,a,i;return Jt(this,void 0,void 0,function(){var c,s;return ye(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=tn(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(c=r.value,t.next(c),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),a={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function On(e,t,n,r,a){r===void 0&&(r=0),a===void 0&&(a=!1);var i=t.schedule(function(){n(),a?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!a)return i}var De=H(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function k(e,t){return y(function(n,r){var a=0;n.subscribe(S(r,function(i){r.next(e.call(t,i,a++))}))})}var Xo=Array.isArray;function Ko(e,t){return Xo(t)?e.apply(void 0,R([],D(t))):e(t)}function gn(e){return k(function(t){return Ko(e,t)})}function xn(e,t,n,r,a,i,c,s){var l=[],u=0,f=0,b=!1,m=function(){b&&!l.length&&!u&&t.complete()},p=function(C){return u<r?B(C):l.push(C)},B=function(C){i&&t.next(C),u++;var x=!1;N(n(C,f++)).subscribe(S(t,function(h){a?.(h),i?p(h):t.next(h)},function(){x=!0},void 0,function(){if(x)try{u--;for(var h=function(){var T=l.shift();c?On(t,c,function(){return B(T)}):B(T)};l.length&&u<r;)h();m()}catch(T){t.error(T)}}))};return e.subscribe(S(t,p,function(){b=!0,m()})),function(){s?.()}}function Y(e,t,n){return n===void 0&&(n=1/0),d(t)?Y(function(r,a){return k(function(i,c){return t(r,i,a,c)})(N(e(r,a)))},n):(typeof t=="number"&&(n=t),y(function(r,a){return xn(r,a,e,n)}))}var Jo=["addListener","removeListener"],ei=["addEventListener","removeEventListener"],ti=["on","off"];function te(e,t,n,r){if(d(n)&&(r=n,n=void 0),r)return te(e,t,n).pipe(gn(r));var a=D(ai(e)?ei.map(function(s){return function(l){return e[s](t,l,n)}}):ni(e)?Jo.map(Pn(e,t)):ri(e)?ti.map(Pn(e,t)):[],2),i=a[0],c=a[1];if(!i&&we(e))return Y(function(s){return te(s,t,n)})(N(e));if(!i)throw new TypeError("Invalid event target");return new O(function(s){var l=function(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];return s.next(1<u.length?u:u[0])};return i(l),function(){return c(l)}})}function Pn(e,t){return function(n){return function(r){return e[n](t,r)}}}function ni(e){return d(e.addListener)&&d(e.removeListener)}function ri(e){return d(e.on)&&d(e.off)}function ai(e){return d(e.addEventListener)&&d(e.removeEventListener)}function ne(e,t){return y(function(n,r){var a=0;n.subscribe(S(r,function(i){return e.call(t,i,a++)&&r.next(i)}))})}function wn(e){return y(function(t,n){var r=!1;t.subscribe(S(n,function(a){r=!0,n.next(a)},function(){r||n.next(e),n.complete()}))})}function Dn(e){return e<=0?function(){return fn}:y(function(t,n){var r=0;t.subscribe(S(n,function(a){++r<=e&&(n.next(a),e<=r&&n.complete())}))})}function kn(e){return e===void 0&&(e=oi),y(function(t,n){var r=!1;t.subscribe(S(n,function(a){r=!0,n.next(a)},function(){return r?n.complete():n.error(e())}))})}function oi(){return new De}function Ue(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?ne(function(a,i){return e(a,i,r)}):q,Dn(1),n?wn(t):kn(function(){return new De}))}}function Le(e){return y(function(t,n){N(e).subscribe(S(n,function(){return n.complete()},J)),!n.closed&&t.subscribe(n)})}function He(e,t,n){var r=d(e)||t||n?{next:e,error:t,complete:n}:e;return r?y(function(a,i){var c;(c=r.subscribe)===null||c===void 0||c.call(r);var s=!0;a.subscribe(S(i,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),i.next(l)},function(){var l;s=!1,(l=r.complete)===null||l===void 0||l.call(r),i.complete()},function(l){var u;s=!1,(u=r.error)===null||u===void 0||u.call(r,l),i.error(l)},function(){var l,u;s&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):q}var An="1",En="2",vn="3",Tn="4",Rn="5",Nn="6",_n="7",Fn="8",Mn="q",Gn="w",Un="e",Ln="r",Hn="t",zn="y",Vn="u",Qn="i",Wn="!",qn="@",Yn="#",$n="$",Zn="%",jn="^",Xn="&",Kn="*",Jn="Q",er="W",tr="E",nr="R",rr="T",ar="Y",or="U",ir="I",cr="p",sr="0",lr="=",ur="-",mr="]",fr="[",qe="0",Ye="1",$e="6",Ze="7",je="2",Xe="3",Ke="4",Je="5",Wr="1",qr="0",Yr="1",$r="2",Zr="3",jr="4",Xr="5",Kr="6",Jr="7",ea="8",ta="Q",na="W",ra="E",aa="R",oa="T",ia="Y",ca="U",sa="I",et="0",tt="1",nt="2",rt="3",at="4",ot="5",it="6",la="X",ua="1",ma="0",fa="x",da="1",Ca="0",pa="1",ha="0",Ae="normal",ct="shorted",st="biasMethod",lt="mvdd",ut="temp",mt="testSig",ft="biasDrp",dt="biasDrn",dr="d",ii="D",ba="Z",Sa="z",Qe="1",We="0",Cr="G",pr="H",hr="J",br="K",Sr="L",yr="A",Ir="S",Br="F",Or="a",ci="j",gr="1hour",xr="2hour",Pr="4hour",wr="12hour",Dr="24hour",kr="5min",Ar="15min",Er="30min",vr="14sec",si="b",li="s",ui="?",Tr="CH1SET",Rr="CH2SET",Nr="CH3SET",_r="CH4SET",Fr="CH5SET",Mr="CH6SET",Gr="CH7SET",Ur="CH8SET",mi="v",fi="c",di="C",Ci="",pi="daisy removed",hi="16",bi="daisy attached16",Si="no daisy to attach!8",yi="g",Ii="f",Bi="`",Oi="<",gi=",",ya="/",Ia="0",Ba="1",Oa="2",ga="3",xi="/",xa="analog",Pa="default",wa="debug",Da="digital",ka="~",Aa="0",Ea="1",va="2",Ta="3",Ra="4",Na="5",_a="6",Fa="0",Ma="1",Ga="2",Ua="3",La="4",Ha="5",za="6",Va="7",Pi="~",wi="n",Di="N",ki="{",Ai="}",Ei=";",vi=":";var re="cyton",ze="cytonBLE",ke="daisy",Ti="default",ae="ganglion",Ve="none",Ri="60Hz",Ni="50Hz",_i="none",Fi="random",Mi="fullBuffers",Gi="oneByOne",Ui="none";var Li="Invalid Packet Byte Length",Hi="Invalid Start Byte",zi="Invalid Stop Byte",Vi="Invalid data - try again",Qi="Invalid type - check comments for input type",Wi="Missing register setting",qi="Missing property in JSON",Yi="Scan already under way",$i="No scan started",Zi="Please turn blue tooth on.",ji="'this.sync.curSyncObj' must not be null",Xi="Missed the time sync sent confirmation. Try sync again",Ki="Undefined or Null Input";var Lr="bad",Hr="none",zr="good",Ji="init",Vr="ok";var ec="OpenBCISimulator";var tc="v1",nc="v2",rc="v3",ac="Daisy",oc="v2",ic="Failure",cc="$$$",sc="Success";var lc="rawAux",uc="standard";var mc="default";var fc="fast",dc="accelerometer",Cc="blePoweredOn",pc="close",hc="droppedPacket",bc="eot",Sc="error",yc="ganglionFound",Ic="hardSet",Bc="impedance",Oc="impedanceArray",gc="message",xc="query",Pc="rawDataPacket",wc="ready",Dc="rfduino",kc="sample",Ac="scanStopped",Ec="synced",vc="wifiShield";var Tc={max:100,min:1},Rc={max:200,min:101},Nc=201,_c=202,Fc=203,Mc=204,Gc=205,Uc=206,Lc=207,Hc=20,zc=2,Vc={auxByte:20,byteId:0,dataStart:1,dataStop:19},Qc={byteId:0,dataStart:1,dataStop:20},Qa=51,Wa=1.2,Ct="Ganglion",Wc="t",qc="T",Yc="z",$c="Z",Zc=Wa/(8388607*Qa*1.5),jc="fe84",Xc="2d30c082f39f4ce6923f3484ea480596",Kc="2d30c083f39f4ce6923f3484ea480596",Jc="2d30c084f39f4ce6923f3484ea480596",es="2220",ts="2221",ns="2222",rs="2223",as=3,os="connect",is="disconnect",cs="discover",ss="servicesDiscover",ls="characteristicsDiscover",us="read",ms="discover",fs="scanStart",ds="scanStop",Cs="stateChange",ps="poweredOn",hs="ble",bs="serial",Ss="wifi",pt=`
LIS3DH Registers
0x07.0
0x08.0
0x09.0
0x0A.0
0x0B.0
0x0C.0
0x0D.0
0x0E.0
0x0F.33

0x1F.0
0x20.8
0x21.0
0x22.0
0x23.18
0x24.0
0x25.0
0x26.0
0x27.0
0x28.0
0x29.0
0x2A.0
0x2B.0
0x2C.0
0x2D.0
0x2E.0
0x2F.20
0x30.0
0x31.0
0x32.0
0x33.0

0x38.0
0x39.0
0x3A.0
0x3B.0
0x3C.0
0x3D.0
`,ht=`
LIS3DH Registers
0x07 00
0x08 00
0x09 00
0x0A 00
0x0B 00
0x0C 00
0x0D 00
0x0E 00
0x0F 33

0x1F 00
0x20 08
0x21 00
0x22 00
0x23 18
0x24 00
0x25 00
0x26 00
0x27 00
0x28 00
0x29 00
0x2A 00
0x2B 00
0x2C 00
0x2D 00
0x2E 00
0x2F 20
0x30 00
0x31 00
0x32 00
0x33 00

0x38 00
0x39 00
0x3A 00
0x3B 00
0x3C 00
0x3D 00
`,ie=`
Board ADS Registers
ADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0
CONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0
CONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0
CONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0
LOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0
CH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0
BIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1
BIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1
LOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0
GPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1
MISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0
MISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0
CONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0
`,bt=`
Daisy ADS Registers
ADS_ID, 00, 3E, 0, 0, 1, 1, 1, 1, 1, 0
CONFIG1, 01, 96, 1, 0, 0, 1, 0, 1, 1, 0
CONFIG2, 02, C0, 1, 1, 0, 0, 0, 0, 0, 0
CONFIG3, 03, EC, 1, 1, 1, 0, 1, 1, 0, 0
LOFF, 04, 02, 0, 0, 0, 0, 0, 0, 1, 0
CH1SET, 05, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH2SET, 06, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH3SET, 07, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH4SET, 08, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH5SET, 09, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH6SET, 0A, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH7SET, 0B, 68, 0, 1, 1, 0, 1, 0, 0, 0
CH8SET, 0C, 68, 0, 1, 1, 0, 1, 0, 0, 0
BIAS_SENSP, 0D, FF, 1, 1, 1, 1, 1, 1, 1, 1
BIAS_SENSN, 0E, FF, 1, 1, 1, 1, 1, 1, 1, 1
LOFF_SENSP, 0F, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_SENSN, 10, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_FLIP, 11, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATP, 12, 00, 0, 0, 0, 0, 0, 0, 0, 0
LOFF_STATN, 13, 00, 0, 0, 0, 0, 0, 0, 0, 0
GPIO, 14, 0F, 0, 0, 0, 0, 1, 1, 1, 1
MISC1, 15, 00, 0, 0, 0, 0, 0, 0, 0, 0
MISC2, 16, 00, 0, 0, 0, 0, 0, 0, 0, 0
CONFIG4, 17, 00, 0, 0, 0, 0, 0, 0, 0, 0
`,ys="MISC1",Is="BIAS_SENSP",Bs=["CH1SET","CH2SET","CH3SET","CH4SET","CH5SET","CH6SET","CH7SET","CH8SET"],Os=ie.length+pt.length,gs=ie.length+bt.length+pt.length,xs=ie.length+ht.length,Ps=ie.length+bt.length+ht.length,qa={OBCIChannelOff1:An,OBCIChannelOff2:En,OBCIChannelOff3:vn,OBCIChannelOff4:Tn,OBCIChannelOff5:Rn,OBCIChannelOff6:Nn,OBCIChannelOff7:_n,OBCIChannelOff8:Fn,OBCIChannelOff9:Mn,OBCIChannelOff10:Gn,OBCIChannelOff11:Un,OBCIChannelOff12:Ln,OBCIChannelOff13:Hn,OBCIChannelOff14:zn,OBCIChannelOff15:Vn,OBCIChannelOff16:Qn,commandChannelOff:function(e){return new Promise(function(t,n){switch(e){case 1:t(An);break;case 2:t(En);break;case 3:t(vn);break;case 4:t(Tn);break;case 5:t(Rn);break;case 6:t(Nn);break;case 7:t(_n);break;case 8:t(Fn);break;case 9:t(Mn);break;case 10:t(Gn);break;case 11:t(Un);break;case 12:t(Ln);break;case 13:t(Hn);break;case 14:t(zn);break;case 15:t(Vn);break;case 16:t(Qn);break;default:n(Error("Error [commandChannelOff]: Invalid Channel Number"));break}})},OBCIChannelOn1:Wn,OBCIChannelOn2:qn,OBCIChannelOn3:Yn,OBCIChannelOn4:$n,OBCIChannelOn5:Zn,OBCIChannelOn6:jn,OBCIChannelOn7:Xn,OBCIChannelOn8:Kn,OBCIChannelOn9:Jn,OBCIChannelOn10:er,OBCIChannelOn11:tr,OBCIChannelOn12:nr,OBCIChannelOn13:rr,OBCIChannelOn14:ar,OBCIChannelOn15:or,OBCIChannelOn16:ir,commandChannelOn:function(e){return new Promise(function(t,n){switch(e){case 1:t(Wn);break;case 2:t(qn);break;case 3:t(Yn);break;case 4:t($n);break;case 5:t(Zn);break;case 6:t(jn);break;case 7:t(Xn);break;case 8:t(Kn);break;case 9:t(Jn);break;case 10:t(er);break;case 11:t(tr);break;case 12:t(nr);break;case 13:t(rr);break;case 14:t(ar);break;case 15:t(or);break;case 16:t(ir);break;default:n(Error("Error [commandChannelOn]: Invalid Channel Number"));break}})},OBCITestSignalConnectToDC:cr,OBCITestSignalConnectToGround:sr,OBCITestSignalConnectToPulse1xFast:lr,OBCITestSignalConnectToPulse1xSlow:ur,OBCITestSignalConnectToPulse2xFast:mr,OBCITestSignalConnectToPulse2xSlow:fr,getTestSignalCommand:e=>new Promise((t,n)=>{switch(e){case"dc":t(cr);break;case"ground":t(sr);break;case"pulse1xFast":t(lr);break;case"pulse1xSlow":t(ur);break;case"pulse2xFast":t(mr);break;case"pulse2xSlow":t(fr);break;case"none":t(dr);break;default:n(Error("Invalid selection! Check your spelling."));break}}),OBCIChannelCmdADCNormal:qe,OBCIChannelCmdADCShorted:Ye,OBCIChannelCmdADCBiasDRP:$e,OBCIChannelCmdADCBiasDRN:Ze,OBCIChannelCmdADCBiasMethod:je,OBCIChannelCmdADCMVDD:Xe,OBCIChannelCmdADCTemp:Ke,OBCIChannelCmdADCTestSig:Je,OBCIChannelCmdBiasInclude:Wr,OBCIChannelCmdBiasRemove:qr,OBCIChannelCmdChannel1:Yr,OBCIChannelCmdChannel2:$r,OBCIChannelCmdChannel3:Zr,OBCIChannelCmdChannel4:jr,OBCIChannelCmdChannel5:Xr,OBCIChannelCmdChannel6:Kr,OBCIChannelCmdChannel7:Jr,OBCIChannelCmdChannel8:ea,OBCIChannelCmdChannel9:ta,OBCIChannelCmdChannel10:na,OBCIChannelCmdChannel11:ra,OBCIChannelCmdChannel12:aa,OBCIChannelCmdChannel13:oa,OBCIChannelCmdChannel14:ia,OBCIChannelCmdChannel15:ca,OBCIChannelCmdChannel16:sa,commandChannelForCmd:St,OBCIChannelCmdGain1:et,OBCIChannelCmdGain2:tt,OBCIChannelCmdGain4:nt,OBCIChannelCmdGain6:rt,OBCIChannelCmdGain8:at,OBCIChannelCmdGain12:ot,OBCIChannelCmdGain24:it,commandForGain:$a,gainForCommand:Rs,OBCIChannelCmdLatch:la,OBCIChannelCmdPowerOff:ua,OBCIChannelCmdPowerOn:ma,OBCIChannelCmdSet:fa,OBCIChannelCmdSRB1Connect:da,OBCIChannelCmdSRB1Diconnect:Ca,OBCIChannelCmdSRB2Connect:pa,OBCIChannelCmdSRB2Diconnect:ha,channelSettingsObjectDefault:Qr,channelSettingsArrayInit:e=>{for(var t=[],n=0;n<e;n++)t.push(Qr(n));return t},OBCIStringADCNormal:Ae,OBCIStringADCShorted:ct,OBCIStringADCBiasMethod:st,OBCIStringADCMvdd:lt,OBCIStringADCTemp:ut,OBCIStringADCTestSig:mt,OBCIStringADCBiasDrp:ft,OBCIStringADCBiasDrn:dt,commandForADCString:Ya,inputTypeForCommand:Ts,OBCIChannelDefaultAllSet:dr,OBCIChannelDefaultAllGet:ii,OBCIChannelImpedanceLatch:ba,OBCIChannelImpedanceSet:Sa,OBCIChannelImpedanceTestSignalApplied:Qe,OBCIChannelImpedanceTestSignalAppliedNot:We,OBCISDLogForHour1:Cr,OBCISDLogForHour2:pr,OBCISDLogForHour4:hr,OBCISDLogForHour12:br,OBCISDLogForHour24:Sr,OBCISDLogForMin5:yr,OBCISDLogForMin15:Ir,OBCISDLogForMin30:Br,OBCISDLogForSec14:Or,OBCISDLogStop:ci,OBCIStringSDHour1:gr,OBCIStringSDHour2:xr,OBCIStringSDHour4:Pr,OBCIStringSDHour12:wr,OBCIStringSDHour24:Dr,OBCIStringSDMin5:kr,OBCIStringSDMin15:Ar,OBCIStringSDMin30:Er,OBCIStringSDSec14:vr,sdSettingForString:e=>new Promise((t,n)=>{switch(e){case gr:t(Cr);break;case xr:t(pr);break;case Pr:t(hr);break;case wr:t(br);break;case Dr:t(Sr);break;case kr:t(yr);break;case Ar:t(Ir);break;case Er:t(Br);break;case vr:t(Or);break;default:n(Error(TypeError));break}}),OBCIStreamStart:si,OBCIStreamStop:li,OBCIAccelStart:wi,OBCIAccelStop:Di,OBCIMiscQueryRegisterSettings:ui,OBCIMiscQueryRegisterSettingsChannel1:Tr,OBCIMiscQueryRegisterSettingsChannel2:Rr,OBCIMiscQueryRegisterSettingsChannel3:Nr,OBCIMiscQueryRegisterSettingsChannel4:_r,OBCIMiscQueryRegisterSettingsChannel5:Fr,OBCIMiscQueryRegisterSettingsChannel6:Mr,OBCIMiscQueryRegisterSettingsChannel7:Gr,OBCIMiscQueryRegisterSettingsChannel8:Ur,channelSettingsKeyForChannel:e=>new Promise((t,n)=>{switch(e){case 1:t(new Buffer(Tr));break;case 2:t(new Buffer(Rr));break;case 3:t(new Buffer(Nr));break;case 4:t(new Buffer(_r));break;case 5:t(new Buffer(Fr));break;case 6:t(new Buffer(Mr));break;case 7:t(new Buffer(Gr));break;case 8:t(new Buffer(Ur));break;default:n(Error("Invalid channel number"));break}}),OBCIMiscSoftReset:mi,OBCIChannelMaxNumber8:fi,OBCIChannelMaxNumber16:di,OBCIChannelMaxNumber8NoDaisyToRemove:Ci,OBCIChannelMaxNumber8SuccessDaisyRemoved:pi,OBCIChannelMaxNumber16DaisyAlreadyAttached:hi,OBCIChannelMaxNumber16DaisyAttached:bi,OBCIChannelMaxNumber16NoDaisyAttached:Si,OBCIFilterDisable:yi,OBCIFilterEnable:Ii,OBCITrigger:Bi,OBCINumberOfChannelsCyton:8,OBCINumberOfChannelsCytonBLE:2,OBCINumberOfChannelsDaisy:16,OBCINumberOfChannelsDefault:8,OBCINumberOfChannelsGanglion:4,OBCIBoardCyton:re,OBCIBoardCytonBLE:ze,OBCIBoardDaisy:ke,OBCIBoardDefault:Ti,OBCIBoardGanglion:ae,OBCIBoardNone:Ve,numberOfChannelsForBoardType:e=>{switch(e){case ke:return 16;case ae:return 4;case Ve:return 0;case ze:return 2;case re:default:return 8}},boardTypeForNumberOfChannels:e=>{switch(e){case 16:return ke;case 4:return ae;case 0:return Ve;case 2:return ze;case 8:default:return re}},OBCISampleRate1000:1e3,OBCISampleRate125:125,OBCISampleRate12800:12800,OBCISampleRate1600:1600,OBCISampleRate16000:16e3,OBCISampleRate200:200,OBCISampleRate2000:2e3,OBCISampleRate250:250,OBCISampleRate25600:25600,OBCISampleRate3200:3200,OBCISampleRate400:400,OBCISampleRate4000:4e3,OBCISampleRate500:500,OBCISampleRate6400:6400,OBCISampleRate800:800,OBCISampleRate8000:8e3,OBCISampleNumberMax:255,OBCIPacketSize:33,OBCIPacketSizeBLECyton:20,OBCIPacketSizeBLERaw:12,OBCIByteStart:160,OBCIByteStop:192,OBCIErrorInvalidByteLength:Li,OBCIErrorInvalidByteStart:Hi,OBCIErrorInvalidByteStop:zi,OBCIErrorInvalidData:Vi,OBCIErrorInvalidType:Qi,OBCIErrorMissingRegisterSetting:Wi,OBCIErrorMissingRequiredProperty:qi,OBCIErrorNobleAlreadyScanning:Yi,OBCIErrorNobleNotAlreadyScanning:$i,OBCIErrorNobleNotInPoweredOnState:Zi,OBCIErrorTimeSyncIsNull:ji,OBCIErrorTimeSyncNoComma:Xi,OBCIErrorUndefinedOrNullInput:Ki,OBCIMasterBufferSize:4096,OBCILeadOffDriveInAmps:6e-9,OBCILeadOffFrequencyHz:31.5,getChannelSetter:ws,getImpedanceSetter:Ds,getSampleRateSetter:ks,getBoardModeSetter:As,OBCIWriteIntervalDelayMSLong:50,OBCIWriteIntervalDelayMSNone:0,OBCIWriteIntervalDelayMSShort:10,OBCISyncTimeSent:gi,OBCISyncTimeSet:Oi,OBCIRadioKey:240,OBCIRadioCmdChannelGet:0,OBCIRadioCmdChannelSet:1,OBCIRadioCmdChannelSetOverride:2,OBCIRadioCmdPollTimeGet:3,OBCIRadioCmdPollTimeSet:4,OBCIRadioCmdBaudRateSetDefault:5,OBCIRadioCmdBaudRateSetFast:6,OBCIRadioCmdSystemStatus:7,OBCIImpedanceTextBad:Lr,OBCIImpedanceTextGood:zr,OBCIImpedanceTextInit:Ji,OBCIImpedanceTextOk:Vr,OBCIImpedanceTextNone:Hr,OBCIImpedanceThresholdBadMax:1e6,OBCIImpedanceSeriesResistor:2200,getTextForRawImpedance:e=>e>0&&e<5e3?zr:e>5001&&e<1e4?Vr:e>10001&&e<1e6?Lr:Hr,OBCISimulatorPortName:ec,OBCIStreamPacketStandardAccel:0,OBCIStreamPacketStandardRawAux:1,OBCIStreamPacketUserDefinedType:2,OBCIStreamPacketAccelTimeSyncSet:3,OBCIStreamPacketAccelTimeSynced:4,OBCIStreamPacketRawAuxTimeSyncSet:5,OBCIStreamPacketRawAuxTimeSynced:6,OBCIStreamPacketImpedance:7,isNumber:oe,isBoolean:G,isString:Ee,isUndefined:Es,isNull:vs,OBCIPacketPositionStartByte:0,OBCIPacketPositionStopByte:32,OBCIPacketPositionStartAux:26,OBCIPacketPositionStopAux:31,OBCIPacketPositionChannelDataStart:2,OBCIPacketPositionChannelDataStop:25,OBCIPacketPositionSampleNumber:1,OBCIPacketPositionTimeSyncAuxStart:26,OBCIPacketPositionTimeSyncAuxStop:28,OBCIPacketPositionTimeSyncTimeStart:28,OBCIPacketPositionTimeSyncTimeStop:32,OBCISimulatorLineNoiseHz60:Ri,OBCISimulatorLineNoiseHz50:Ni,OBCISimulatorLineNoiseNone:_i,OBCISimulatorFragmentationRandom:Fi,OBCISimulatorFragmentationFullBuffers:Mi,OBCISimulatorFragmentationOneByOne:Gi,OBCISimulatorFragmentationNone:Ui,OBCIFirmwareV1:tc,OBCIFirmwareV2:nc,OBCIFirmwareV3:rc,OBCIAccelAxisX:7,OBCIAccelAxisY:8,OBCIAccelAxisZ:9,OBCIStreamPacketTimeByteSize:4,OBCIParseDaisy:ac,OBCIParseFailure:ic,OBCIParseFirmware:oc,OBCIParseEOT:cc,OBCIParseSuccess:sc,OBCIParsingChannelSettings:2,OBCIParsingEOT:4,OBCIParsingNormal:3,OBCIParsingReset:0,OBCIParsingTimeSyncSent:1,OBCITimeoutProcessBytes:500,OBCISimulatorRawAux:lc,OBCISimulatorStandard:uc,OBCIRadioChannelMax:25,OBCIRadioChannelMin:1,OBCIRadioPollTimeMax:255,OBCIRadioPollTimeMin:0,OBCITimeSyncArraySize:10,OBCITimeSyncMultiplierWithSyncConf:.9,OBCITimeSyncMultiplierWithoutSyncConf:.75,OBCITimeSyncThresholdTransFailureMS:10,OBCIBoardModeSet:ya,OBCIBoardModeCmdDefault:Ia,OBCIBoardModeCmdDebug:Ba,OBCIBoardModeCmdAnalog:Oa,OBCIBoardModeCmdDigital:ga,OBCIBoardModeCmdGetCur:xi,OBCIBoardModeAnalog:xa,OBCIBoardModeDefault:Pa,OBCIBoardModeDebug:wa,OBCIBoardModeDigital:Da,OBCISampleRateSet:ka,OBCISampleRateCmdCyton16000:Aa,OBCISampleRateCmdCyton8000:Ea,OBCISampleRateCmdCyton4000:va,OBCISampleRateCmdCyton2000:Ta,OBCISampleRateCmdCyton1000:Ra,OBCISampleRateCmdCyton500:Na,OBCISampleRateCmdCyton250:_a,OBCISampleRateCmdGang25600:Fa,OBCISampleRateCmdGang12800:Ma,OBCISampleRateCmdGang6400:Ga,OBCISampleRateCmdGang3200:Ua,OBCISampleRateCmdGang1600:La,OBCISampleRateCmdGang800:Ha,OBCISampleRateCmdGang400:za,OBCISampleRateCmdGang200:Va,OBCISampleRateCmdGetCur:Pi,OBCIWifiAttach:ki,OBCIWifiRemove:Ai,OBCIWifiReset:Ei,OBCIWifiStatus:vi,OBCIRadioBaudRateDefault:115200,OBCIRadioBaudRateDefaultStr:mc,OBCIRadioBaudRateFast:230400,OBCIRadioBaudRateFastStr:fc,OBCIEmitterAccelerometer:dc,OBCIEmitterBlePoweredUp:Cc,OBCIEmitterClose:pc,OBCIEmitterDroppedPacket:hc,OBCIEmitterEot:bc,OBCIEmitterError:Sc,OBCIEmitterGanglionFound:yc,OBCIEmitterHardSet:Ic,OBCIEmitterImpedance:Bc,OBCIEmitterImpedanceArray:Oc,OBCIEmitterMessage:gc,OBCIEmitterQuery:xc,OBCIEmitterRawDataPacket:Pc,OBCIEmitterReady:wc,OBCIEmitterRFduino:Dc,OBCIEmitterSample:kc,OBCIEmitterScanStopped:Ac,OBCIEmitterSynced:Ec,OBCIEmitterWifiShield:vc,OBCIGanglionAccelAxisX:1,OBCIGanglionAccelAxisY:2,OBCIGanglionAccelAxisZ:3,OBCIGanglionBleSearchTime:2e4,OBCIGanglionByteIdUncompressed:0,OBCIGanglionByteId18Bit:Tc,OBCIGanglionByteId19Bit:Rc,OBCIGanglionByteIdImpedanceChannel1:Nc,OBCIGanglionByteIdImpedanceChannel2:_c,OBCIGanglionByteIdImpedanceChannel3:Fc,OBCIGanglionByteIdImpedanceChannel4:Mc,OBCIGanglionByteIdImpedanceChannelReference:Gc,OBCIGanglionByteIdMultiPacket:Uc,OBCIGanglionByteIdMultiPacketStop:Lc,OBCIGanglionMCP3912Gain:Qa,OBCIGanglionMCP3912Vref:Wa,OBCIGanglionPacketSize:Hc,OBCIGanglionPacket18Bit:Vc,OBCIGanglionPacket19Bit:Qc,OBCIGanglionPrefix:Ct,OBCIGanglionSamplesPerPacket:zc,OBCIGanglionSyntheticDataEnable:Wc,OBCIGanglionSyntheticDataDisable:qc,OBCIGanglionImpedanceStart:Yc,OBCIGanglionImpedanceStop:$c,OBCIGanglionScaleFactorPerCountVolts:Zc,SimbleeUuidService:jc,SimbleeUuidReceive:Xc,SimbleeUuidSend:Kc,SimbleeUuidDisconnect:Jc,RFduinoUuidService:es,RFduinoUuidReceive:ts,RFduinoUuidSend:ns,RFduinoUuidSendTwo:rs,OBCICytonBLESamplesPerPacket:as,OBCIGanglionAccelScaleFactor:.016,OBCINobleEmitterPeripheralConnect:os,OBCINobleEmitterPeripheralDisconnect:is,OBCINobleEmitterPeripheralDiscover:cs,OBCINobleEmitterPeripheralServicesDiscover:ss,OBCINobleEmitterServiceCharacteristicsDiscover:ls,OBCINobleEmitterServiceRead:us,OBCINobleEmitterDiscover:ms,OBCINobleEmitterScanStart:fs,OBCINobleEmitterScanStop:ds,OBCINobleEmitterStateChange:Cs,OBCINobleStatePoweredOn:ps,getPeripheralLocalNames:Fs,getPeripheralWithLocalName:Ms,getVersionNumber:Gs,isPeripheralGanglion:Us,commandSampleRateForCmdCyton:Za,commandSampleRateForCmdGanglion:ja,commandBoardModeForMode:Xa,rawDataToSampleObjectDefault:Ns,OBCIProtocolBLE:hs,OBCIProtocolSerial:bs,OBCIProtocolWifi:Ss,OBCIRegisterQueryAccelerometerFirmwareV1:pt,OBCIRegisterQueryAccelerometerFirmwareV3:ht,OBCIRegisterQueryCyton:ie,OBCIRegisterQueryCytonDaisy:bt,OBCIRegisterQueryNameMISC1:ys,OBCIRegisterQueryNameBIASSENSP:Is,OBCIRegisterQueryNameCHnSET:Bs,OBCIRegisterQuerySizeCytonFirmwareV1:Os,OBCIRegisterQuerySizeCytonDaisyFirmwareV1:gs,OBCIRegisterQuerySizeCytonFirmwareV3:xs,OBCIRegisterQuerySizeCytonDaisyFirmwareV3:Ps};function ws(e,t,n,r,a,i,c){var s,l,u,f;return new Promise(function(b,m){oe(e)||m(Error("channelNumber must be of type 'number' ")),G(t)||m(Error("powerDown must be of type 'boolean' ")),oe(n)||m(Error("gain must be of type 'number' ")),Ee(r)||m(Error("inputType must be of type 'string' ")),G(a)||m(Error("bias must be of type 'boolean' ")),G(i)||m(Error("srb1 must be of type 'boolean' ")),G(c)||m(Error("srb2 must be of type 'boolean' "));var p=St(e).catch(h=>m(h));s=t?ua:ma;var B=$a(n).catch(h=>m(h)),C=Ya(r).catch(h=>m(h));l=a?Wr:qr,u=i?pa:ha,f=c?da:Ca;var x={channelNumber:e,powerDown:t,gain:n,inputType:r,bias:a,srb2:i,srb1:c};Promise.all([p,B,C]).then(function(h){var T=[fa,h[0],s,h[1],h[2],l,u,f,la];b({commandArray:T,newChannelSettingsObject:x})})})}function Ds(e,t,n){var r,a;return new Promise((i,c)=>{oe(e)||c(Error("channelNumber must be of type 'number' ")),G(t)||c(Error("pInputApplied must be of type 'boolean' ")),G(n)||c(Error("nInputApplied must be of type 'boolean' ")),a=t?Qe:We,r=n?Qe:We,St(e).then(s=>{var l=[Sa,s,a,r,ba];i(l)}).catch(s=>c(s))})}function ks(e,t){return new Promise((n,r)=>{if(!Ee(e))return r(Error("board type must be of type 'string' "));if(!oe(t))return r(Error("sampleRate must be of type 'number' "));t=Math.floor(t);let a;if(e===re||e===ke)a=Za;else if(e===ae)a=ja;else return r(Error(`boardType must be either ${re} or ${ae}`));a(t).then(i=>{var c=[ka,i];n(c)}).catch(i=>r(i))})}function As(e){return new Promise((t,n)=>{if(!Ee(e))return n(Error("board mode must be of type 'string' "));Xa(e).then(r=>{var a=[ya,r];t(a)}).catch(r=>n(r))})}function oe(e){return typeof e=="number"}function G(e){return typeof e=="boolean"}function Ee(e){return typeof e=="string"}function Es(e){return typeof e=="undefined"}function vs(e){return e===null}function Ya(e){return new Promise(function(t,n){switch(e){case Ae:t(qe);break;case ct:t(Ye);break;case st:t(je);break;case lt:t(Xe);break;case ut:t(Ke);break;case mt:t(Je);break;case ft:t($e);break;case dt:t(Ze);break;default:n(Error("Invalid ADC string"));break}})}function Ts(e){switch(String(e)){case qe:return Ae;case Ye:return ct;case je:return st;case Xe:return lt;case Ke:return ut;case Je:return mt;case $e:return ft;case Ze:return dt;default:throw new Error("Invalid input type, must be less than 8")}}function $a(e){return new Promise(function(t,n){switch(e){case 1:t(et);break;case 2:t(tt);break;case 4:t(nt);break;case 6:t(rt);break;case 8:t(at);break;case 12:t(ot);break;case 24:t(it);break;default:n(Error("Invalid gain setting of "+e+" gain must be (1,2,4,6,8,12,24)"));break}})}function Rs(e){switch(String(e)){case et:return 1;case tt:return 2;case nt:return 4;case rt:return 6;case at:return 8;case ot:return 12;case it:return 24;default:throw new Error(`Invalid gain setting of ${e} gain must be (0,1,2,3,4,5,6)`)}}function St(e){return new Promise(function(t,n){switch(e){case 1:t(Yr);break;case 2:t($r);break;case 3:t(Zr);break;case 4:t(jr);break;case 5:t(Xr);break;case 6:t(Kr);break;case 7:t(Jr);break;case 8:t(ea);break;case 9:t(ta);break;case 10:t(na);break;case 11:t(ra);break;case 12:t(aa);break;case 13:t(oa);break;case 14:t(ia);break;case 15:t(ca);break;case 16:t(sa);break;default:n(Error("Invalid channel number"));break}})}function Qr(e){return{channelNumber:e,powerDown:!1,gain:24,inputType:Ae,bias:!0,srb2:!0,srb1:!1}}function Ns(e){return e===void 0&&(e=8),{accelArray:[0,0,0],channelSettings:qa.channelSettingsArrayInit(e),decompressedSamples:_s(e),lastSampleNumber:0,rawDataPacket:Buffer.alloc(33),rawDataPackets:[],scale:!0,sendCounts:!1,timeOffset:0,verbose:!1}}function _s(e){let t=[];for(let n=0;n<3;n++)t.push(new Array(e));return t}function Za(e){return new Promise(function(t,n){switch(e){case 16e3:t(Aa);break;case 8e3:t(Ea);break;case 4e3:t(va);break;case 2e3:t(Ta);break;case 1e3:t(Ra);break;case 500:t(Na);break;case 250:t(_a);break;default:n(Error("Invalid sample rate"));break}})}function ja(e){return new Promise(function(t,n){switch(e){case 25600:t(Fa);break;case 12800:t(Ma);break;case 6400:t(Ga);break;case 3200:t(Ua);break;case 1600:t(La);break;case 800:t(Ha);break;case 400:t(za);break;case 200:t(Va);break;default:n(Error("Invalid sample rate"));break}})}function Xa(e){return new Promise(function(t,n){switch(e){case Pa:t(Ia);break;case wa:t(Ba);break;case xa:t(Oa);break;case Da:t(ga);break;default:n(Error("Invalid sample rate"));break}})}function Fs(e){return new Promise((t,n)=>{var r=[];return e.forEach(a=>{r.push(a.advertisement.localName)}),r.length>0?t(r):n(Error(`No peripherals discovered with prefix equal to ${Ct}`))})}function Ms(e,t){return new Promise((n,r)=>typeof e!="object"?r(Error("pArray must be of type Object")):(e.forEach(a=>{if(a.advertisement.hasOwnProperty("localName")&&a.advertisement.localName===t)return n(a)}),r(Error(`No peripheral found with localName: ${t}`))))}function Gs(e){return Number(e[1])}function Us(e){return!!(e&&e.hasOwnProperty("advertisement")&&e.advertisement!==null&&e.advertisement.hasOwnProperty("localName")&&e.advertisement.localName!==void 0&&e.advertisement.localName!==null&&e.advertisement.localName.indexOf(Ct)>-1)}var o=qa;var U=4.5,$=.002/Math.pow(2,4),ro=3,g={extractRawDataPackets:e=>{if(!e)return{buffer:e,rawDataPackets:[]};let t=e.length,n=[];if(t<o.OBCIPacketSize)return{buffer:e,rawDataPackets:n};let r=0;for(;r<=t-o.OBCIPacketSize;){if(e[r]===o.OBCIByteStart&&le(e[r+o.OBCIPacketSize-1])){let a;a=Uint8Array.from(e.slice(r,r+o.OBCIPacketSize)),n.push(a);let i;r>0?i=Uint8Array.concat([Uint8Array.from(e.slice(0,r)),Uint8Array.from(e.slice(r+o.OBCIPacketSize))]):i=Uint8Array.from(e.slice(o.OBCIPacketSize)),i.length===0?e=null:e=Uint8Array.from(i),r=-1,t-=o.OBCIPacketSize}r++}return{buffer:e,rawDataPackets:n}},extractRawBLEDataPackets:e=>{let t=[];if(o.isNull(e)||e.byteLength!==o.OBCIPacketSizeBLECyton)return t;let n=[0,0,0];n[0]=e[1],n[1]=n[0]+1,n[1]>255&&(n[1]-=256),n[2]=n[1]+1,n[2]>255&&(n[2]-=256);for(let r=0;r<o.OBCICytonBLESamplesPerPacket;r++){let a=g.samplePacketZero(n[r]);a[0]=o.OBCIByteStart,a[o.OBCIPacketPositionStopByte]=e[0],e.copy(a,o.OBCIPacketPositionChannelDataStart,o.OBCIPacketPositionChannelDataStart+r*6,o.OBCIPacketPositionChannelDataStart+6+r*6),t.push(a)}return t},transformRawDataPacketToSample:co,transformRawDataPacketsToSample:Ws,convertGanglionArrayToBuffer:qs,getRawPacketType:mo,getFromTimePacketAccel:so,getFromTimePacketTime:Pt,getFromTimePacketRawAux:wt,ganglionFillRawDataPacket:Ys,parsePacketStandardAccel:$s,parsePacketStandardRawAux:Zs,parsePacketTimeSyncedAccel:js,parsePacketTimeSyncedRawAux:Xs,parsePacketImpedance:Ks,convertSampleToPacketStandard:e=>{let t=new Uint8Array(o.OBCIPacketSize);t.fill(0),t[0]=o.OBCIByteStart,t[1]=e.sampleNumber;for(let n=0;n<o.OBCINumberOfChannelsDefault;n++)se(e.channelData[n]).copy(t,2+n*3);for(let n=0;n<3;n++)eo(e.auxData[n]).copy(t,o.OBCIPacketSize-1-6+n*2);return t[o.OBCIPacketSize-1]=o.OBCIByteStop,t},convertSampleToPacketRawAux:(e,t)=>{let n=new Uint8Array(o.OBCIPacketSize);n.fill(0),n[0]=o.OBCIByteStart,n[1]=e.sampleNumber;for(let r=0;r<o.OBCINumberOfChannelsDefault;r++)se(e.channelData[r]).copy(n,2+r*3);return t.copy(n,26),n[o.OBCIPacketSize-1]=I(o.OBCIStreamPacketStandardRawAux),n},convertSampleToPacketAccelTimeSyncSet:(e,t)=>{let n=no(e,t);return n[o.OBCIPacketPositionStopByte]=I(o.OBCIStreamPacketAccelTimeSyncSet),n},convertSampleToPacketAccelTimeSynced:no,convertSampleToPacketRawAuxTimeSyncSet:(e,t,n)=>{let r=to(e,t,n);return r[o.OBCIPacketPositionStopByte]=I(o.OBCIStreamPacketRawAuxTimeSyncSet),r},convertSampleToPacketRawAuxTimeSynced:to,debugPrettyPrint:e=>{if(e==null)console.log("== Sample is undefined ==");else{console.log("-- Sample --"),console.log("---- Start Byte: "+e.startByte),console.log("---- Sample Number: "+e.sampleNumber);for(let t=0;t<8;t++)console.log("---- Channel Data "+(t+1)+": "+e.channelData[t]);if(e.accelData)for(let t=0;t<3;t++)console.log("---- Accel Data "+t+": "+e.accelData[t]);e.auxData&&console.log("---- Aux Data "+e.auxData),console.log("---- Stop Byte: "+e.stopByte)}},samplePrintHeader:()=>`All voltages in Volts!sampleNumber, channel1, channel2, channel3, channel4, channel5, channel6, channel7, channel8, aux1, aux2, aux3
`,samplePrintLine:e=>new Promise((t,n)=>{e==null&&n(Error("undefined sample")),t(e.sampleNumber+","+e.channelData[0].toFixed(8)+","+e.channelData[1].toFixed(8)+","+e.channelData[2].toFixed(8)+","+e.channelData[3].toFixed(8)+","+e.channelData[4].toFixed(8)+","+e.channelData[5].toFixed(8)+","+e.channelData[6].toFixed(8)+","+e.channelData[7].toFixed(8)+","+e.auxData[0].toFixed(8)+","+e.auxData[1].toFixed(8)+","+e.auxData[2].toFixed(8)+`
`)}),floatTo3ByteBuffer:se,floatTo2ByteBuffer:eo,impedanceCalculationForChannel:(e,t)=>{let n=Math.sqrt(2);return new Promise((r,a)=>{e==null&&a(Error("Sample Object cannot be null or undefined")),(e.channelData===void 0||e.channelData===null)&&a(Error("Channel cannot be null or undefined")),(t<1||t>o.OBCINumberOfChannelsDefault)&&a(Error("Channel number invalid."));let i=t-1;e.channelData[i]<0&&(e.channelData[i]*=-1);let c=n*e.channelData[i]/o.OBCILeadOffDriveInAmps;r(c)})},impedanceCalculationForAllChannels:e=>{let t=Math.sqrt(2);return new Promise((n,r)=>{e==null&&r(Error("Sample Object cannot be null or undefined")),(e.channelData===void 0||e.channelData===null)&&r(Error("Channel cannot be null or undefined"));let a=[],i=e.channelData.length;for(let c=0;c<i;c++){e.channelData[c]<0&&(e.channelData[c]*=-1);let s=t*e.channelData[c]/o.OBCILeadOffDriveInAmps;a.push(s)}e.impedances=a,n(e)})},interpret16bitAsInt32:e=>{let t=0;return e[0]>127&&(t=65535),t<<16|e[0]<<8|e[1]},interpret24bitAsInt32:e=>{let t=0;return e[0]>127&&(t=255),t<<24|e[0]<<16|e[1]<<8|e[2]},impedanceArray:e=>{let t=[];for(let n=0;n<e;n++)t.push(Ja(n+1));return t},impedanceObject:Ja,impedanceSummarize:e=>{e.raw>o.OBCIImpedanceThresholdBadMax?e.text=o.OBCIImpedanceTextNone:e.text=o.getTextForRawImpedance(e.raw)},newSample:fo,newSampleNoScale:Co,scaleFactorAux:$,impedanceCalculateArray:(e,t)=>{if(t.buffer.push(e.channelData),t.count++,t.count>=t.window){let n=[];for(let r=0;r<e.channelData.length;r++){let a=0;for(let s=0;s<t.window;s++)t.buffer[r][s]>a&&(a=t.buffer[r][s]);let i=0;for(let s=0;s<t.window;s++)t.buffer[r][s]<i&&(i=t.buffer[r][s]);let c=a-i;n.push(c/2/o.OBCILeadOffDriveInAmps)}return t.count=0,n}return null},impedanceTestObjDefault:e=>{let t=e||{};return t.active=!1,t.buffer=[],t.count=0,t.isTestingPInput=!1,t.isTestingNInput=!1,t.onChannel=0,t.sampleNumber=0,t.continuousMode=!1,t.impedanceForChannel=0,t.window=40,t},samplePacket:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,0,0,1,0,2,I(o.OBCIStreamPacketStandardAccel)]),samplePacketZero:e=>new Uint8Array([160,A(e),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,I(o.OBCIStreamPacketStandardAccel)]),samplePacketReal:e=>new Uint8Array([160,A(e),143,242,64,143,223,244,144,43,182,143,191,191,127,255,255,127,255,255,148,37,52,32,182,125,0,224,0,224,15,112,I(o.OBCIStreamPacketStandardAccel)]),samplePacketStandardRawAux:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,2,3,4,5,I(o.OBCIStreamPacketStandardRawAux)]),samplePacketAccelTimeSyncSet:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,I(o.OBCIStreamPacketAccelTimeSyncSet)]),samplePacketAccelTimeSynced:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,I(o.OBCIStreamPacketAccelTimeSynced)]),samplePacketRawAuxTimeSyncSet:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,I(o.OBCIStreamPacketRawAuxTimeSyncSet)]),samplePacketRawAuxTimeSynced:e=>new Uint8Array([160,A(e),0,0,1,0,0,2,0,0,3,0,0,4,0,0,5,0,0,6,0,0,7,0,0,8,0,1,0,0,0,1,I(o.OBCIStreamPacketRawAuxTimeSynced)]),samplePacketImpedance:e=>new Uint8Array([160,e,54,52,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,I(o.OBCIStreamPacketImpedance)]),samplePacketUserDefined:()=>new Uint8Array([160,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,I(o.OBCIStreamPacketUserDefinedType)]),samplePacketCytonBLE:e=>new Uint8Array([192,A(e),0,0,1,0,0,2,0,0,10,0,0,20,0,0,100,0,0,200]),getBiasSetFromADSRegisterQuery:It,getBooleanFromRegisterQuery:ue,getChannelDataArray:me,getChannelDataArrayNoScale:fe,getDataArrayAccel:lo,getDataArrayAccelNoScale:uo,getFirmware:rl,getSRB1FromADSRegisterQuery:yt,getNumFromThreeCSVADSRegisterQuery:Bt,isEven:po,isOdd:nl,isStopByte:le,isTimeSyncSetConfirmationInBuffer:ol,makeDaisySampleObject:el,makeDaisySampleObjectWifi:tl,makeTailByteFromPacketType:I,newSyncObject:Qs,setChSetFromADSRegisterQuery:Ot,stripToEOTBuffer:al,syncChannelSettingsWithRawData:Js,droppedPacketCheck:(e,t)=>{if(e===o.OBCISampleNumberMax&&t===0||t-e===1)return null;let n=[];if(e>t){let r=o.OBCISampleNumberMax-e;for(let a=0;a<r;a++)n.push(e+a+1);e=-1}for(let r=1;r<t-e;r++)n.push(e+r);return n},convert18bitAsInt32:E,convert19bitAsInt32:v,decompressDeltas18Bit:oo,decompressDeltas19Bit:io,sampleCompressedData:e=>new Uint8Array([e,0,0,0,0,8,0,5,0,0,72,0,9,240,1,176,0,48,0,8]),sampleBLERaw:()=>new Uint8Array([0,0,1,0,0,2,0,0,3,0,0,4]),sampleImpedanceChannel1:()=>new Uint8Array([o.OBCIGanglionByteIdImpedanceChannel1,0,0,1]),sampleImpedanceChannel2:()=>new Uint8Array([o.OBCIGanglionByteIdImpedanceChannel2,0,0,1]),sampleImpedanceChannel3:()=>new Uint8Array([o.OBCIGanglionByteIdImpedanceChannel3,0,0,1]),sampleImpedanceChannel4:()=>new Uint8Array([o.OBCIGanglionByteIdImpedanceChannel4,0,0,1]),sampleImpedanceChannelReference:()=>new Uint8Array([o.OBCIGanglionByteIdImpedanceChannelReference,0,0,1]),sampleMultiBytePacket:e=>{let t=new Uint8Array([o.OBCIGanglionByteIdMultiPacket]);return Uint8Array.concat([t,e])},sampleMultiBytePacketStop:e=>{let t=new Uint8Array([o.OBCIGanglionByteIdMultiPacketStop]);return Uint8Array.concat([t,e])},sampleOtherData:e=>{let t=new Uint8Array([255]);return Uint8Array.concat([t,e])},sampleUncompressedData:()=>new Uint8Array([0,0,0,1,0,0,2,0,0,3,0,0,4,1,2,3,4,5,6,7]),parseGanglion:Ls,processMultiBytePacket:gt,processMultiBytePacketStop:ao};function Ls(e){let t=parseInt(e.rawDataPacket[0]);if(t<=o.OBCIGanglionByteId19Bit.max)return xt(e);switch(t){case o.OBCIGanglionByteIdMultiPacket:return gt(e);case o.OBCIGanglionByteIdMultiPacketStop:return ao(e);case o.OBCIGanglionByteIdImpedanceChannel1:case o.OBCIGanglionByteIdImpedanceChannel2:case o.OBCIGanglionByteIdImpedanceChannel3:case o.OBCIGanglionByteIdImpedanceChannel4:case o.OBCIGanglionByteIdImpedanceChannelReference:return zs(e);default:return null}}function Hs(e){e.lastSampleNumber=parseInt(e.rawDataPacket[0]);let t=[];if(e.lastSampleNumber<=o.OBCIGanglionByteId18Bit.max)switch(Ka(e,oo(e.rawDataPacket.slice(o.OBCIGanglionPacket18Bit.dataStart,o.OBCIGanglionPacket18Bit.dataStop))),t.push(ce(e.lastSampleNumber*2-1,e.decompressedSamples[1],e.sendCounts)),t.push(ce(e.lastSampleNumber*2,e.decompressedSamples[2],e.sendCounts)),e.lastSampleNumber%10){case o.OBCIGanglionAccelAxisX:e.accelArray[0]=e.sendCounts?e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1):e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1)*o.OBCIGanglionAccelScaleFactor;break;case o.OBCIGanglionAccelAxisY:e.accelArray[1]=e.sendCounts?e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1):e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1)*o.OBCIGanglionAccelScaleFactor;break;case o.OBCIGanglionAccelAxisZ:e.accelArray[2]=e.sendCounts?e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1):e.rawDataPacket.readInt8(o.OBCIGanglionPacket18Bit.auxByte-1)*o.OBCIGanglionAccelScaleFactor,e.sendCounts?t[0].accelData=e.accelArray:t[0].accelDataCounts=e.accelArray;break;default:break}else Ka(e,io(e.rawDataPacket.slice(o.OBCIGanglionPacket19Bit.dataStart,o.OBCIGanglionPacket19Bit.dataStop))),t.push(ce((e.lastSampleNumber-100)*2-1,e.decompressedSamples[1],e.sendCounts)),t.push(ce((e.lastSampleNumber-100)*2,e.decompressedSamples[2],e.sendCounts));for(let n=0;n<o.OBCINumberOfChannelsGanglion;n++)e.decompressedSamples[0][n]=e.decompressedSamples[2][n];return t}function zs(e){let t=parseInt(e.rawDataPacket[0]),n;switch(t){case o.OBCIGanglionByteIdImpedanceChannel1:n=1;break;case o.OBCIGanglionByteIdImpedanceChannel2:n=2;break;case o.OBCIGanglionByteIdImpedanceChannel3:n=3;break;case o.OBCIGanglionByteIdImpedanceChannel4:n=4;break;case o.OBCIGanglionByteIdImpedanceChannelReference:n=0;break}let r={channelNumber:n,impedanceValue:0},a=e.rawDataPacket.length;for(;Number.isNaN(Number(e.rawDataPacket.slice(1,a)))&&a!==0;)a--;return a!==0&&(r.impedanceValue=Number(e.rawDataPacket.slice(1,a))),r}function gt(e){e.multiPacketBuffer?e.multiPacketBuffer=Uint8Array.concat([Uint8Array.from(e.multiPacketBuffer),Uint8Array.from(e.rawDataPacket.slice(o.OBCIGanglionPacket19Bit.dataStart,o.OBCIGanglionPacket19Bit.dataStop))]):e.multiPacketBuffer=e.rawDataPacket.slice(o.OBCIGanglionPacket19Bit.dataStart,o.OBCIGanglionPacket19Bit.dataStop)}function ao(e){gt(e);let t=e.multiPacketBuffer.toString();return e.multiPacketBuffer=null,{message:t}}function Ka(e,t){for(let n=1;n<3;n++)for(let r=0;r<4;r++)e.decompressedSamples[n][r]=e.decompressedSamples[n-1][r]-t[n-1][r]}function ce(e,t,n){let r;if(n)r=Co(e),r.channelDataCounts=t;else{r=fo(e);for(let a=0;a<o.OBCINumberOfChannelsGanglion;a++)r.channelData.push(t[a]*o.OBCIGanglionScaleFactorPerCountVolts)}return r.timestamp=Date.now(),r}function xt(e){return parseInt(e.rawDataPacket[0])===o.OBCIGanglionByteIdUncompressed?Vs(e):Hs(e)}function Vs(e){e.lastSampleNumber=o.OBCIGanglionByteIdUncompressed;for(let t=0;t<4;t++)e.decompressedSamples[0][t]=g.interpret24bitAsInt32(e.rawDataPacket.slice(1+t*3,1+t*3+3));return[ce(0,e.decompressedSamples[0],e.sendCounts)]}function E(e){let t=0;return e[2]&1>0&&(t=16383),t<<18|e[0]<<16|e[1]<<8|e[2]}function v(e){let t=0;return e[2]&1>0&&(t=8191),t<<19|e[0]<<16|e[1]<<8|e[2]}function oo(e){let t=new Array(o.OBCIGanglionSamplesPerPacket);t[0]=[0,0,0,0],t[1]=[0,0,0,0];let n=[];for(let a=0;a<o.OBCIGanglionSamplesPerPacket;a++)n.push([0,0,0,0]);let r;return r=new Uint8Array([e[0]>>6,(e[0]&63)<<2|e[1]>>6,(e[1]&63)<<2|e[2]>>6]),n[0][0]=E(r),r=new Uint8Array([(e[2]&63)>>4,e[2]<<4|e[3]>>4,e[3]<<4|e[4]>>4]),n[0][1]=E(r),r=new Uint8Array([(e[4]&15)>>2,e[4]<<6|e[5]>>2,e[5]<<6|e[6]>>2]),n[0][2]=E(r),r=new Uint8Array([e[6]&3,e[7],e[8]]),n[0][3]=E(r),r=new Uint8Array([e[9]>>6,(e[9]&63)<<2|e[10]>>6,(e[10]&63)<<2|e[11]>>6]),n[1][0]=E(r),r=new Uint8Array([(e[11]&63)>>4,e[11]<<4|e[12]>>4,e[12]<<4|e[13]>>4]),n[1][1]=E(r),r=new Uint8Array([(e[13]&15)>>2,e[13]<<6|e[14]>>2,e[14]<<6|e[15]>>2]),n[1][2]=E(r),r=new Uint8Array([e[15]&3,e[16],e[17]]),n[1][3]=E(r),n}function io(e){let t=new Array(o.OBCIGanglionSamplesPerPacket);t[0]=[0,0,0,0],t[1]=[0,0,0,0];let n=[];for(let a=0;a<o.OBCIGanglionSamplesPerPacket;a++)n.push([0,0,0,0]);let r;return r=new Uint8Array([e[0]>>5,(e[0]&31)<<3|e[1]>>5,(e[1]&31)<<3|e[2]>>5]),n[0][0]=v(r),r=new Uint8Array([(e[2]&31)>>2,e[2]<<6|e[3]>>2,e[3]<<6|e[4]>>2]),n[0][1]=v(r),r=new Uint8Array([(e[4]&3)<<1|e[5]>>7,(e[5]&127)<<1|e[6]>>7,(e[6]&127)<<1|e[7]>>7]),n[0][2]=v(r),r=new Uint8Array([(e[7]&127)>>4,(e[7]&15)<<4|e[8]>>4,(e[8]&15)<<4|e[9]>>4]),n[0][3]=v(r),r=new Uint8Array([(e[9]&15)>>1,e[9]<<7|e[10]>>1,e[10]<<7|e[11]>>1]),n[1][0]=v(r),r=new Uint8Array([(e[11]&1)<<2|e[12]>>6,e[12]<<2|e[13]>>6,e[13]<<2|e[14]>>6]),n[1][1]=v(r),r=new Uint8Array([(e[14]&56)>>3,(e[14]&7)<<5|(e[15]&248)>>3,(e[15]&7)<<5|(e[16]&248)>>3]),n[1][2]=v(r),r=new Uint8Array([e[16]&7,e[17],e[18]]),n[1][3]=v(r),n}function Ja(e){return{channel:e,P:{raw:-1,text:o.OBCIImpedanceTextInit},N:{raw:-1,text:o.OBCIImpedanceTextInit}}}function Qs(){return{boardTime:0,correctedTransmissionTime:!1,error:null,timeSyncSent:0,timeSyncSentConfirmation:0,timeSyncSetPacket:0,timeRoundTrip:0,timeTransmission:0,timeOffset:0,timeOffsetMaster:0,valid:!1}}function Ws(e){let t=[];for(let n=0;n<e.rawDataPackets.length;n++){e.rawDataPacket=e.rawDataPackets[n];let r=co(e);t.push(r),r.hasOwnProperty("sampleNumber")?e.lastSampleNumber=r.sampleNumber:r.hasOwnProperty("impedanceValue")||(e.lastSampleNumber=e.rawDataPacket[o.OBCIPacketPositionSampleNumber])}return t}function co(e){let t;try{switch(mo(e.rawDataPacket[o.OBCIPacketPositionStopByte])){case o.OBCIStreamPacketStandardAccel:t=g.parsePacketStandardAccel(e);break;case o.OBCIStreamPacketStandardRawAux:t=g.parsePacketStandardRawAux(e);break;case o.OBCIStreamPacketAccelTimeSyncSet:case o.OBCIStreamPacketAccelTimeSynced:t=g.parsePacketTimeSyncedAccel(e);break;case o.OBCIStreamPacketRawAuxTimeSyncSet:case o.OBCIStreamPacketRawAuxTimeSynced:t=g.parsePacketTimeSyncedRawAux(e);break;case o.OBCIStreamPacketImpedance:t=g.parsePacketImpedance(e);break;default:t={error:`bad stop byte ${e.rawDataPacket.slice(32,33).toString("hex")}`,valid:!1,rawDataPacket:e.rawDataPacket},e.verbose&&console.log(t.error);break}}catch(n){t={error:n,valid:!1,rawDataPacket:e.rawDataPacket},e.verbose&&console.log(n)}return t}function qs(e,t){for(let n=0;n<o.OBCINumberOfChannelsGanglion;n++)t.writeInt16BE(e[n]>>8,n*3),t.writeInt8(e[n]&255,n*3+2)}function Ys(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket)||o.isUndefined(e.data)||o.isNull(e.data))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(!e.hasOwnProperty("sampleNumber"))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);if(e.data.byteLength!==o.OBCIPacketSizeBLERaw)throw new Error(o.OBCIErrorInvalidByteLength);e.data.copy(e.rawDataPacket,o.OBCIPacketPositionChannelDataStart),e.rawDataPacket[o.OBCIPacketPositionSampleNumber]=e.sampleNumber,e.rawDataPacket[o.OBCIPacketPositionStartByte]=o.OBCIByteStart,e.rawDataPacket[o.OBCIPacketPositionStopByte]=o.OBCIStreamPacketStandardRawAux}function $s(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);if(e.rawDataPacket[0]!==o.OBCIByteStart)throw new Error(o.OBCIErrorInvalidByteStart);let t={};return(o.isUndefined(e.scale)||o.isNull(e.scale))&&(e.scale=!0),e.scale?t.accelData=lo(e.rawDataPacket.slice(o.OBCIPacketPositionStartAux,o.OBCIPacketPositionStopAux+1)):t.accelDataCounts=uo(e.rawDataPacket.slice(o.OBCIPacketPositionStartAux,o.OBCIPacketPositionStopAux+1)),e.scale?t.channelData=me(e):t.channelDataCounts=fe(e),t.auxData=Uint8Array.from(e.rawDataPacket.slice(o.OBCIPacketPositionStartAux,o.OBCIPacketPositionStopAux+1)),t.sampleNumber=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],t.startByte=e.rawDataPacket[0],t.stopByte=e.rawDataPacket[o.OBCIPacketPositionStopByte],t.valid=!0,t.timestamp=Date.now(),t.boardTime=0,t}function Zs(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);if(e.rawDataPacket[0]!==o.OBCIByteStart)throw new Error(o.OBCIErrorInvalidByteStart);let t={};return(o.isUndefined(e.scale)||o.isNull(e.scale))&&(e.scale=!0),e.scale?t.channelData=me(e):t.channelDataCounts=fe(e),t.auxData=Uint8Array.from(e.rawDataPacket.slice(o.OBCIPacketPositionStartAux,o.OBCIPacketPositionStopAux+1)),t.sampleNumber=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],t.startByte=e.rawDataPacket[0],t.stopByte=e.rawDataPacket[o.OBCIPacketPositionStopByte],t.valid=!0,t.timestamp=Date.now(),t.boardTime=0,t}function js(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);if(e.rawDataPacket[0]!==o.OBCIByteStart)throw new Error(o.OBCIErrorInvalidByteStart);let t={};return t.sampleNumber=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],t.startByte=e.rawDataPacket[0],t.stopByte=e.rawDataPacket[o.OBCIPacketPositionStopByte],t.boardTime=Pt(e.rawDataPacket),e.hasOwnProperty("timeOffset")?t.timestamp=t.boardTime+e.timeOffset:t.timestamp=Date.now(),t.auxData=wt(e.rawDataPacket),(o.isUndefined(e.scale)||o.isNull(e.scale))&&(e.scale=!0),e.scale?t.channelData=me(e):t.channelDataCounts=fe(e),so(e)&&(e.scale?t.accelData=e.accelArray:t.accelDataCounts=e.accelArray),t.valid=!0,t}function Xs(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);if(e.rawDataPacket[0]!==o.OBCIByteStart)throw new Error(o.OBCIErrorInvalidByteStart);let t={};return t.sampleNumber=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],t.startByte=e.rawDataPacket[0],t.stopByte=e.rawDataPacket[o.OBCIPacketPositionStopByte],t.boardTime=Pt(e.rawDataPacket),e.hasOwnProperty("timeOffset")?t.timestamp=t.boardTime+e.timeOffset:t.timestamp=Date.now(),t.auxData=wt(e.rawDataPacket),(o.isUndefined(e.scale)||o.isNull(e.scale))&&(e.scale=!0),e.scale?t.channelData=me(e):t.channelDataCounts=fe(e),t.valid=!0,t}function Ks(e){if(o.isUndefined(e)||o.isUndefined(e.rawDataPacket)||o.isNull(e.rawDataPacket))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);let t={};return t.channelNumber=e.rawDataPacket[1],t.channelNumber===5&&(t.channelNumber=0),t.impedanceValue=Number(e.rawDataPacket.toString().match(/\d+/)[0]),t}function ue(e,t,n){let r=e.match(t);if(r){let a=parseInt(e.charAt(r.index+n));if(Number.isNaN(a))throw new Error(o.OBCIErrorInvalidData);return Boolean(a)}else throw new Error(o.OBCIErrorMissingRegisterSetting)}function yt(e){return ue(e,o.OBCIRegisterQueryNameMISC1,21)}function It(e,t){return ue(e,o.OBCIRegisterQueryNameBIASSENSP,20+t*3)}function Bt(e,t,n){let r=e.match(t);if(r){let a=parseInt(e.charAt(r.index+n)),i=parseInt(e.charAt(r.index+n+3)),c=parseInt(e.charAt(r.index+n+6));if(!Number.isNaN(a)&&!Number.isNaN(i)&&!Number.isNaN(c))return a<<2|i<<1|c;throw new Error(o.OBCIErrorInvalidData)}else throw new Error(o.OBCIErrorMissingRegisterSetting)}function Ot(e,t){let n=o.OBCIRegisterQueryNameCHnSET[t.channelNumber];n===void 0&&(n=o.OBCIRegisterQueryNameCHnSET[t.channelNumber-o.OBCINumberOfChannelsCyton]),t.powerDown=ue(e,n,16),t.gain=o.gainForCommand(Bt(e,n,19)),t.inputType=o.inputTypeForCommand(Bt(e,n,31)),t.srb2=ue(e,n,28)}function Js(e){if(o.isUndefined(e)||o.isUndefined(e.channelSettings)||o.isNull(e.channelSettings)||o.isUndefined(e.data)||o.isNull(e.data))throw new Error(o.OBCIErrorUndefinedOrNullInput);if(!Array.isArray(e.channelSettings))throw new Error(`${o.OBCIErrorInvalidType} channelSettings`);if(e.channelSettings.length===o.OBCINumberOfChannelsCyton){if(e.data.toString().match(/Daisy ADS/))throw new Error("raw data mismatch - expected only cyton register info but also found daisy");if(e.data.toString().match(/Board ADS/)==null)throw new Error(o.OBCIErrorInvalidData)}else{if(e.data.toString().match(/Daisy ADS/)==null)throw new Error("raw data mismatch - expected daisy register info but none found");if(e.data.toString().match(/Board ADS/)==null)throw new Error("no Board ADS info found")}e.channelSettings.forEach(c=>{if(!c.hasOwnProperty("channelNumber")||!c.hasOwnProperty("powerDown")||!c.hasOwnProperty("gain")||!c.hasOwnProperty("inputType")||!c.hasOwnProperty("bias")||!c.hasOwnProperty("srb2")||!c.hasOwnProperty("srb1"))throw new Error(o.OBCIErrorMissingRequiredProperty)});let t=null,n=!1,r=!1,a=e.data.toString().match(/Board ADS/),i=e.data.toString().slice(a.index,o.OBCIRegisterQueryCyton.length);if(yt(i)&&(n=!0),e.channelSettings.length>o.OBCINumberOfChannelsCyton){let c=e.data.toString().match(/Daisy ADS/);t=e.data.toString().slice(c.index,c.index+o.OBCIRegisterQueryCytonDaisy.length),yt(i)&&(r=!0)}e.channelSettings.forEach(c=>{c.channelNumber<o.OBCINumberOfChannelsCyton?(Ot(i,c),c.bias=It(i,c.channelNumber),c.srb1=n):(Ot(t,c),c.bias=It(t,c.channelNumber-o.OBCINumberOfChannelsCyton),c.srb1=r)})}function Pt(e){let t=o.OBCIPacketSize-1;if(e.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);return e.readUInt32BE(t-o.OBCIStreamPacketTimeByteSize)}function so(e){let n=o.OBCIPacketSize-1-o.OBCIStreamPacketTimeByteSize-2;if(e.rawDataPacket.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);let r=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],a=g.interpret16bitAsInt32(e.rawDataPacket.slice(n,n+2));switch(r%10){case o.OBCIAccelAxisX:return e.accelArray[0]=e.scale?a*$:a,!1;case o.OBCIAccelAxisY:return e.accelArray[1]=e.scale?a*$:a,!1;case o.OBCIAccelAxisZ:return e.accelArray[2]=e.scale?a*$:a,!0;default:return!1}}function wt(e){if(e.byteLength!==o.OBCIPacketSize)throw new Error(o.OBCIErrorInvalidByteLength);return Uint8Array.from(e.slice(o.OBCIPacketPositionTimeSyncAuxStart,o.OBCIPacketPositionTimeSyncAuxStop))}function lo(e){let t=[];for(let n=0;n<ro;n++){let r=n*2;t.push(g.interpret16bitAsInt32(e.slice(r,r+2))*$)}return t}function uo(e){let t=[];for(let n=0;n<ro;n++){let r=n*2;t.push(g.interpret16bitAsInt32(e.slice(r,r+2)))}return t}function me(e){if(!Array.isArray(e.channelSettings))throw new Error("Error [getChannelDataArray]: Channel Settings must be an array!");e.hasOwnProperty("protocol")||(e.protocol=o.OBCIProtocolSerial);let t=[],n=e.channelSettings.length,r=e.rawDataPacket[o.OBCIPacketPositionSampleNumber],a=n===o.OBCINumberOfChannelsDaisy,i=o.OBCINumberOfChannelsCyton;a||(i=e.channelSettings.length);for(let c=0;c<i;c++){if(!e.channelSettings[c].hasOwnProperty("gain"))throw new Error(`Error [getChannelDataArray]: Invalid channel settings object at index ${c}`);if(!o.isNumber(e.channelSettings[c].gain))throw new Error("Error [getChannelDataArray]: Property gain of channelSettingsObject not or type Number");let s=0;if(e.protocol===o.OBCIProtocolSerial)po(r)&&a?s=U/e.channelSettings[c+o.OBCINumberOfChannelsDefault].gain/(Math.pow(2,23)-1):s=U/e.channelSettings[c].gain/(Math.pow(2,23)-1);else if(e.protocol===o.OBCIProtocolWifi)a?e.lastSampleNumber===r?s=U/e.channelSettings[c+o.OBCINumberOfChannelsDefault].gain/(Math.pow(2,23)-1):s=U/e.channelSettings[c].gain/(Math.pow(2,23)-1):e.channelSettings.length===o.OBCINumberOfChannelsCyton?s=U/e.channelSettings[c].gain/(Math.pow(2,23)-1):s=o.OBCIGanglionScaleFactorPerCountVolts;else if(e.protocol===o.OBCIProtocolBLE)s=U/e.channelSettings[c].gain/(Math.pow(2,23)-1);else throw new Error("Error [getChannelDataArray]: Invalid protocol must be wifi or serial");t.push(s*g.interpret24bitAsInt32(e.rawDataPacket.slice(c*3+o.OBCIPacketPositionChannelDataStart,c*3+o.OBCIPacketPositionChannelDataStart+3)))}return t}function fe(e){if(!Array.isArray(e.channelSettings))throw new Error("Error [getChannelDataArrayNoScale]: Channel Settings must be an array!");let t=[],n=e.channelSettings.length;n>o.OBCINumberOfChannelsDefault&&(n=o.OBCINumberOfChannelsDefault);for(let r=0;r<n;r++)t.push(g.interpret24bitAsInt32(e.rawDataPacket.slice(r*3+o.OBCIPacketPositionChannelDataStart,r*3+o.OBCIPacketPositionChannelDataStart+3)));return t}function mo(e){return e&15}function A(e){return e||e===0?e>255&&(e=255):e=69,e}function fo(e){return e||e===0?e>255&&(e=255):e=0,{startByte:o.OBCIByteStart,sampleNumber:e,channelData:[],accelData:[],auxData:null,stopByte:o.OBCIByteStop,boardTime:0,timestamp:0,valid:!0}}function Co(e){return e||e===0?e>255&&(e=255):e=0,{startByte:o.OBCIByteStart,sampleNumber:e,channelDataCounts:[],accelDataCounts:[],auxData:null,stopByte:o.OBCIByteStop,boardTime:0,timestamp:0,valid:!0}}function se(e){let t=new Uint8Array(3);t.fill(0);let n=e/(U/24/(Math.pow(2,23)-1));return n=Math.floor(n),t[2]=n&255,t[1]=(n&255<<8)>>8,t[0]=(n&255<<16)>>16,t}function eo(e){let t=new Uint8Array(2);t.fill(0);let n=e/$;return n=Math.floor(n),t[1]=n&255,t[0]=(n&255<<8)>>8,t}function el(e,t){let n={};return e.hasOwnProperty("channelData")&&(n.channelData=e.channelData.concat(t.channelData)),e.hasOwnProperty("channelDataCounts")&&(n.channelDataCounts=e.channelDataCounts.concat(t.channelDataCounts)),n.sampleNumber=Math.floor(t.sampleNumber/2),n.auxData={lower:e.auxData,upper:t.auxData},n.stopByte=e.stopByte,n.timestamp=(e.timestamp+t.timestamp)/2,n._timestamps={lower:e.timestamp,upper:t.timestamp},e.hasOwnProperty("accelData")&&(e.accelData[0]>0||e.accelData[1]>0||e.accelData[2]>0?n.accelData=e.accelData:n.accelData=t.accelData),e.hasOwnProperty("accelDataCounts")&&(e.accelDataCounts[0]>0||e.accelDataCounts[1]>0||e.accelDataCounts[2]>0?n.accelDataCounts=e.accelDataCounts:n.accelDataCounts=t.accelDataCounts),n.valid=!0,n}function tl(e,t){let n={};return e.hasOwnProperty("channelData")&&(n.channelData=e.channelData.concat(t.channelData)),e.hasOwnProperty("channelDataCounts")&&(n.channelDataCounts=e.channelDataCounts.concat(t.channelDataCounts)),n.sampleNumber=t.sampleNumber,n.auxData={lower:e.auxData,upper:t.auxData},e.hasOwnProperty("timestamp")&&(n.timestamp=e.timestamp),n.stopByte=e.stopByte,n._timestamps={lower:e.timestamp,upper:t.timestamp},e.hasOwnProperty("accelData")&&(e.accelData[0]>0||e.accelData[1]>0||e.accelData[2]>0?n.accelData=e.accelData:n.accelData=t.accelData),e.hasOwnProperty("accelDataCounts")&&(e.accelDataCounts[0]>0||e.accelDataCounts[1]>0||e.accelDataCounts[2]>0?n.accelDataCounts=e.accelDataCounts:n.accelDataCounts=t.accelDataCounts),n.valid=!0,n}function po(e){return e%2===0}function nl(e){return e%2===1}function rl(e){let t=/v\d.\d*.\d*/,n=e.toString().match(t);if(n){let r=n[0].split(".");return{major:Number(r[0][1]),minor:Number(r[1]),patch:Number(r[2]),raw:n[0]}}else return n}function al(e){let t=e.indexOf(o.OBCIParseEOT);if(t>=0)t+=o.OBCIParseEOT.length;else return e;return t<e.byteLength?Uint8Array.from(e.slice(t)):null}function ol(e){if(e){let t=e.length;switch(t){case 0:return!1;case 1:return e[0]===o.OBCISyncTimeSent.charCodeAt(0);case 2:return e[1]===o.OBCIByteStart?e[0]===o.OBCISyncTimeSent.charCodeAt(0):le(e[0])?e[1]===o.OBCISyncTimeSent.charCodeAt(0):!1;default:if(e[0]===o.OBCISyncTimeSent.charCodeAt(0)&&e[1]===o.OBCIByteStart)return!0;for(let n=1;n<t;n++)if(n===t-1){if(le(e[n-1]))return e[n]===o.OBCISyncTimeSent.charCodeAt(0)}else if(le(e[n-1])&&e[n+1]===o.OBCIByteStart)return e[n]===o.OBCISyncTimeSent.charCodeAt(0);return!1}}}function to(e,t,n){let r=new Uint8Array(o.OBCIPacketSize);r.fill(0),r[0]=o.OBCIByteStart,r[1]=e.sampleNumber;for(let a=0;a<o.OBCINumberOfChannelsDefault;a++)se(e.channelData[a]).copy(r,2+a*3);return n.copy(r,26),r.writeInt32BE(t,28),r[o.OBCIPacketSize-1]=I(o.OBCIStreamPacketRawAuxTimeSynced),r}function no(e,t){let n=new Uint8Array(o.OBCIPacketSize);n.fill(0),n[0]=o.OBCIByteStart,n[1]=e.sampleNumber;for(let r=0;r<o.OBCINumberOfChannelsDefault;r++)se(e.channelData[r]).copy(n,2+r*3);return n.writeInt32BE(t,28),n[o.OBCIPacketSize-1]=I(o.OBCIStreamPacketAccelTimeSynced),n}function I(e){return(e<0||e>15)&&(e=0),o.OBCIByteStop|e}function le(e){return(e&240)===o.OBCIByteStop}var ho=n=>{var r=n,{channelData:e}=r,t=At(r,["channelData"]);return j(Z({},t),{data:e})};var bo="ganglion",So={reader:"2d30c082-f39f-4ce6-923f-3484ea480596",writer:"2d30c083-f39f-4ce6-923f-3484ea480596",connection:"2d30c084-f39f-4ce6-923f-3484ea480596"},yo="characteristicvaluechanged",Io="gattserverdisconnected",Bo={filters:[{namePrefix:"Ganglion-"}],optionalServices:[65156]},Oo={start:"b",accelData:"n"};function cl(e){let t=parseInt(e.rawDataPacket[0]);if(t<=o.OBCIGanglionByteId19Bit.max)return xt(e);switch(t){case o.OBCIGanglionByteIdMultiPacket:return processMultiBytePacket(e);case o.OBCIGanglionByteIdMultiPacketStop:return processMultiBytePacketStop(e);case o.OBCIGanglionByteIdImpedanceChannel1:case o.OBCIGanglionByteIdImpedanceChannel2:case o.OBCIGanglionByteIdImpedanceChannel3:case o.OBCIGanglionByteIdImpedanceChannel4:case o.OBCIGanglionByteIdImpedanceChannelReference:return processImpedanceData(e);default:return null}}var de=class{constructor(t={}){this.options=t,this.gatt=null,this.device=null,this.deviceName=null,this.service=null,this.characteristics=null,this.onDisconnect$=new M,this.boardName=bo,this.channelSize=4;function n(i){return{channelNumber:i,powerDown:!1,gain:24,inputType:"normal",bias:!0,srb2:!0,srb1:!1}}let r=i=>{for(var c=[],s=0;s<i;s++)c.push(n(s));return c};function a(i){let c=[];for(let s=0;s<3;s++)c.push(new Array(i));return c}this.rawDataPacketToSample={accelArray:[0,0,0],channelSettings:r(4),decompressedSamples:a(4),lastSampleNumber:0,rawDataPacket:new Uint8Array(33).buffer,rawDataPackets:[],scale:!0,sendCounts:!1,timeOffset:0,verbose:!1},this.connectionStatus=new Ge(!1),this.stream=new M().pipe(k(i=>this.eventToBufferMapper(i)),He(i=>this.setRawDataPacket(i)),k(()=>cl(this.rawDataPacketToSample)),Y(i=>i),k(ho),Le(this.onDisconnect$)),this.accelData=this.stream.pipe(ne(i=>i.accelData.length))}eventToBufferMapper(t){return new Uint8Array(t.target.value.buffer)}setRawDataPacket(t){this.rawDataPacketToSample.rawDataPacket=t}connect(){return X(this,null,function*(){this.device=yield navigator.bluetooth.requestDevice(Bo),this.addDisconnectedEvent(),this.gatt=yield this.device.gatt.connect(),this.deviceName=this.gatt.device.name,this.service=yield this.gatt.getPrimaryService(65156),this.setCharacteristics(yield this.service.getCharacteristics()),this.connectionStatus.next(!0)})}setCharacteristics(t){this.characteristics=Object.entries(So).reduce((n,[r,a])=>j(Z({},n),{[r]:t.find(i=>i.uuid===a)}),{})}start(){return X(this,null,function*(){let{reader:t,writer:n}=this.characteristics,r=Object.entries(Oo).reduce((a,[i,c])=>j(Z({},a),{[i]:new TextEncoder().encode(c)}),{});t.startNotifications(),t.addEventListener(yo,a=>{this.stream.next(a)}),this.options.accelData&&(yield n.writeValue(r.accelData),t.readValue()),yield n.writeValue(r.start),t.readValue()})}addDisconnectedEvent(){te(this.device,Io).pipe(Ue()).subscribe(()=>{this.gatt=null,this.device=null,this.deviceName=null,this.service=null,this.characteristics=null,this.connectionStatus.next(!1)})}disconnect(){!this.gatt||(this.onDisconnect$.next(),this.gatt.disconnect())}},go=de;var sl=["FP1","FP2","C3","C4"],xo=go,Po=e=>X(void 0,null,function*(){let t=e.device;yield t.start(),t.stream.subscribe(n=>{let r={};n.data.forEach((a,i)=>r[sl[i]]=a),e.ondata(r,n.timestamp)})});var ul={label:"ganglion",device:xo,onconnect:Po,protocols:["bluetooth"]};["Ganglion"].forEach(e=>{ve[e]&&(globalThis[e]=ve[e])});})();
